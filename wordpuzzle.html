<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lang Land - Word Puzzle</title>
  <style>
    :root{
      --bg:#d91563;
      --accent:#247bca;
      --accent-2:#e84251;
      --soft:#bfedfb;
      --lime:#16d6b7;
      --gold:#d91563;
      --ink:#1b1b1b;
    }
    body.pag-puzzle{
      min-height:100vh; margin:0; padding:0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      display:flex; flex-direction:column;
      position:relative;
      overflow-x:hidden;
    }
    .estrela-bg{ position:absolute; inset:0; width:100vw; height:100vh; pointer-events:none; z-index:0; overflow:hidden; }
    .estrelinha{ position:absolute; color: var(--gold); opacity:.8; animation: estrelaMove 8s linear infinite; }
    @keyframes estrelaMove{ 0%{ transform: translateY(-20px);} 100%{ transform: translateY(100vh);} }

    header{ display:flex; align-items:center; justify-content:space-between; padding:15px 20px; background: var(--soft); z-index:2; position:relative; }
    .logo img{ width:145px; cursor:pointer; }
    .perfil-icon{ width:70px; cursor:pointer; }
    .centro-header{ text-align:center; flex:1; }
    h1{ color: var(--gold); font-size:2rem; margin:0; }

    main{ flex:1; display:flex; align-items:center; justify-content:center; padding:20px; z-index:2; position:relative; }
    .game-wrapper{ width:100%; max-width:1100px; display:flex; flex-wrap:wrap; align-items:center; gap:24px; justify-content:center; }
    .left-panel{ flex:1 1 360px; display:flex; flex-direction:column; align-items:center; gap:16px; }
    .mascote{ width:100%; max-width:420px; aspect-ratio: 4/3; background: var(--soft); border-radius:16px; display:flex; align-items:center; justify-content:center; box-shadow:0 8px 24px rgba(0,0,0,.12); }
    .mascote span{ font-size:96px; }
    .tips{ background: #ffffff22; color:#fff; padding:12px 16px; border-radius:12px; text-align:center; font-weight:600; backdrop-filter: blur(2px); }
    .right-panel{ flex:1 1 480px; background: #ffffff18; border-radius:16px; padding:20px; box-shadow:0 8px 24px rgba(0,0,0,.15); }
    .top-row{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
    .title{ color:#fff; font-weight:800; letter-spacing:.5px; }
    .controls{ display:flex; flex-wrap:wrap; gap:10px; }
    button{ border:none; border-radius:10px; padding:10px 14px; font-size:1rem; cursor:pointer; background: var(--accent); color:#fff; transition:.2s; font-weight:700; }
    button:hover{ background: var(--accent-2); transform: translateY(-1px); }
    .ghost{ background:#ffffff2a; color:#fff; }
    .level-selection{ display:flex; gap:10px; flex-wrap:wrap; }
    .level-selection button{ background:var(--soft); color: var(--ink); }
    .level-selection button.active{ background: var(--lime); color:#fff; }
    .board{ display:flex; flex-direction:column; gap:16px; background:#ffffff10; border-radius:12px; padding:16px; }
    .slots{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
    .slot{ width:56px; height:56px; border-radius:10px; background: var(--soft); display:flex; align-items:center; justify-content:center; font-weight:900; font-size:1.4rem; color: var(--ink); box-shadow: inset 0 -2px 0 rgba(0,0,0,.08); }
    .slot.filled{ background:#fff; }
    .bank{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
    .tile{ width:56px; height:56px; border-radius:10px; background: var(--soft); display:flex; align-items:center; justify-content:center; font-weight:900; font-size:1.4rem; color: var(--ink); cursor:grab; user-select:none; box-shadow:0 6px 0 rgba(0,0,0,.15); }
    .tile:active{ cursor:grabbing; }
    .tile.dragging{ opacity:.6; transform: scale(.96); }
    .feedback{ text-align:center; font-size:1.1rem; font-weight:800; padding:6px 10px; border-radius:8px; }
    .ok{ background:#1b9e77; color:#fff; }
    .no{ background:#b00020; color:#fff; }
    .statusbar{ display:flex; align-items:center; justify-content:space-between; gap:10px; color:#fff; font-weight:700; }
    footer{ text-align:center; padding:15px; font-size:14px; color:#fff; background: var(--accent); margin-top:auto; cursor:pointer; }
    @media (max-width:760px){
      .mascote{ display:none; }
      .tips{ font-size:.95rem; }
      .slot, .tile{ width:52px; height:52px; font-size:1.3rem; }
    }
    .mascote img{ max-width:100%; max-height:100%; object-fit: contain; border-radius:12px; }
  </style>
</head>
<body class="pag-puzzle">
  <div class="estrela-bg" id="estrela-bg"></div>

  <header>
    <div class="logo">
      <img src="img/LOGOdeitada.png" alt="Lang Land Logo" onclick="window.location.href='jogos.html'" />
    </div>
    <div class="centro-header">
      <h1>Word Puzzle</h1>
    </div>
    <div class="icones-conta">
      <a href="conta.html"><img class="perfil-icon" src="img/Contapessoal.png" alt="Perfil" /></a>
    </div>
  </header>

  <main>
    <div class="game-wrapper">
      <div class="left-panel">
        <div class="mascote" aria-hidden="true">
          <img src="img/mascote.png" alt="Mascote Lang Land" />
        </div>
        <div class="tips">Arraste as letras para formar a palavra em inglês. Treina vocabulário e reconhecimento de letras!</div>
      </div>

      <div class="right-panel">
        <div class="top-row">
          <h2 class="title">Forme a palavra correta</h2>
          <div class="controls">
            <button id="btn-shuffle" title="Embaralhar letras">Embaralhar</button>
            <button id="btn-clear" class="ghost" title="Limpar">Limpar</button>
            <button id="btn-next" title="Próxima">Próxima ▶</button>
          </div>
        </div>

        <div class="board">
          <div class="level-selection" id="level-selection">
            <button data-level="facil" class="active">Fácil</button>
            <button data-level="medio">Médio</button>
            <button data-level="dificil">Difícil</button>
          </div>

          <div class="statusbar">
            <div>Rodada: <span id="round">1</span>/<span id="total">3</span></div>
            <div>Pontos: <span id="score">0</span></div>
          </div>

          <div id="slots" class="slots" aria-label="Espaços para montar a palavra"></div>
          <div id="bank" class="bank" aria-label="Letras embaralhadas para arrastar"></div>
          <div id="feedback" class="feedback" style="display:none;"></div>
        </div>
      </div>
    </div>
  </main>

  <footer id="footer-link">
    <p>© 2025 Lang Land. Todos os direitos reservados.</p>
  </footer>

  <script>
    // Bloqueio para usuários não cadastrados
    document.addEventListener('DOMContentLoaded', function(){
      if(localStorage.getItem('usuarioCadastrado') !== 'true'){
        alert('Você precisa fazer o cadastro para acessar os jogos.');
        window.location.href = 'index.html';
      }
      // Estrelas animadas
      const estrelaBg = document.getElementById('estrela-bg');
      for(let i=0;i<22;i++){
        const e = document.createElement('span');
        e.className = 'estrelinha';
        e.textContent = '★';
        e.style.left = Math.random()*100 + 'vw';
        e.style.top = (-30 - Math.random()*60) + 'px';
        e.style.fontSize = (18 + Math.random()*22) + 'px';
        e.style.opacity = (0.5 + Math.random()*0.5);
        e.style.animationDuration = (6 + Math.random()*4) + 's';
        e.style.animationDelay = (Math.random()*8) + 's';
        estrelaBg.appendChild(e);
      }
    });

    // Palavras por nível
    const WORDS = {
      facil: ["CAT","DOG","SUN","CAR","BUS"],
      medio: ["APPLE","HOUSE","TRAIN","MUSIC","WATER"],
      dificil: ["ELEPHANT","BUTTERFLY","COMPUTER","RAINBOW","UMBRELLA"]
    };

    let state = { level: 'facil', roundIndex: 0, score: 0, currentWord: '' };

    const elSlots = document.getElementById('slots');
    const elBank = document.getElementById('bank');
    const elRound = document.getElementById('round');
    const elTotal = document.getElementById('total');
    const elScore = document.getElementById('score');
    const elFeedback = document.getElementById('feedback');

    function updateTotal(){ elTotal.textContent = WORDS[state.level].length; }
    function shuffleArray(arr){ const a=arr.slice(); for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
    function shuffledLettersFor(word){ let letters=word.split(''); let shuffled=shuffleArray(letters); if(letters.join('')===shuffled.join('') && letters.length>1){ [shuffled[0],shuffled[1]]=[shuffled[1],shuffled[0]]; } return shuffled; }
    function clearBoard(){ elSlots.innerHTML=''; elBank.innerHTML=''; hideFeedback(); }
    function showFeedback(ok){ elFeedback.textContent = ok?'Correct!':'Try again!'; elFeedback.className='feedback '+(ok?'ok':'no'); elFeedback.style.display='block'; }
    function hideFeedback(){ elFeedback.style.display='none'; }

    function renderRound(){
      clearBoard();
      const word = WORDS[state.level][state.roundIndex];
      state.currentWord = word;
      elRound.textContent = (state.roundIndex+1);
      updateTotal();

      for(let i=0;i<word.length;i++){
        const slot = document.createElement('div');
        slot.className='slot';
        slot.dataset.index=i;
        slot.dataset.accepts='true';
        addDropHandlers(slot);
        elSlots.appendChild(slot);
      }

      const shuffled = shuffledLettersFor(word);
      shuffled.forEach(ch=>{
        const tile = document.createElement('div');
        tile.className='tile'; tile.textContent=ch; tile.draggable=true; tile.dataset.letter=ch; tile.dataset.from='bank';
        addDragHandlers(tile); elBank.appendChild(tile);
      });
    }

    function addDragHandlers(tile){
      tile.addEventListener('dragstart', (e)=>{ tile.classList.add('dragging'); e.dataTransfer.setData('text/plain', tile.dataset.letter); if(!tile.id){ tile.id='tile-'+Math.random().toString(36).slice(2);} e.dataTransfer.setData('text/tile-id', tile.id); });
      tile.addEventListener('dragend', ()=>{ tile.classList.remove('dragging'); });
    }

    function addDropHandlers(target){
      target.addEventListener('dragover', (e)=>{ e.preventDefault(); });
      target.addEventListener('drop', (e)=>{
        e.preventDefault();
        const tileId=e.dataTransfer.getData('text/tile-id'); const tile=document.getElementById(tileId); if(!tile) return;
        if(target.firstChild){ elBank.appendChild(target.firstChild); }
        target.appendChild(tile);
        target.classList.add('filled');
        checkIfComplete();
      });
    }

    elSlots.addEventListener('click', (e)=>{
      const slot=e.target.closest('.slot');
      if(slot && slot.firstChild){ elBank.appendChild(slot.firstChild); slot.classList.remove('filled'); hideFeedback(); }
    });

    function currentAnswer(){ return Array.from(elSlots.children).map(slot=> slot.firstChild ? slot.firstChild.dataset.letter : '').join(''); }
    function checkIfComplete(){
      const answer=currentAnswer();
      if(answer.length!==state.currentWord.length){ hideFeedback(); return; }
      if(answer===state.currentWord){ showFeedback(true); state.score+=10; elScore.textContent=state.score; } else { showFeedback(false); }
    }

    document.getElementById('btn-shuffle').addEventListener('click', ()=>{
      const letters=Array.from(elBank.children).map(t=>t.dataset.letter);
      const shuffled=shuffleArray(letters); elBank.innerHTML='';
      shuffled.forEach(ch=>{ const tile=document.createElement('div'); tile.className='tile'; tile.textContent=ch; tile.draggable=true; tile.dataset.letter=ch; addDragHandlers(tile); elBank.appendChild(tile); });
      hideFeedback();
    });

    document.getElementById('btn-clear').addEventListener('click', ()=>{
      Array.from(elSlots.children).forEach(slot=>{ if(slot.firstChild){ elBank.appendChild(slot.firstChild);} slot.classList.remove('filled'); });
      hideFeedback();
    });

    document.getElementById('btn-next').addEventListener('click', ()=>{
      const answer=currentAnswer();
      if(answer===state.currentWord){
        if(state.roundIndex+1<WORDS[state.level].length){ state.roundIndex++; renderRound(); hideFeedback(); }
        else { alert('Você concluiu o nível! Ótimo trabalho!'); state.roundIndex=0; state.score=0; elScore.textContent=0; renderRound(); }
      } else { alert('Monte a palavra correta para avançar :)'); }
    });

    document.getElementById('level-selection').addEventListener('click',(e)=>{
      const btn=e.target.closest('button[data-level]'); if(!btn) return;
      document.querySelectorAll('.level-selection button').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active'); state.level=btn.dataset.level; state.roundIndex=0; state.score=0; elScore.textContent=0; renderRound();
    });

    // Footer clicável
    document.getElementById("footer-link").addEventListener("click", function(){
      window.location.href="privacidade.html";
    });

    // Inicializa
    renderRound();
  </script>
</body>
</html>
